graph TD
    %% ========== AUTHENTICATION & REGISTRATION ==========
    Start([üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤—Ö–æ–¥–∏—Ç—å –Ω–∞ —Å–∞–π—Ç])
    
    AuthCheck{–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á<br/>–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π?}
    
    %% Login Flow
    LoginStart["üîê –°—Ç–æ—Ä—ñ–Ω–∫–∞ –≤—Ö–æ–¥—É"]
    EnterLoginCreds["–í–≤–µ–¥–µ–Ω–Ω—è email —Ç–∞ –ø–∞—Ä–æ–ª—è"]
    ValidateLoginCreds{–î–∞–Ω—ñ<br/>–≤–∞–ª—ñ–¥–Ω—ñ?}
    LoginError["‚ùå –ü–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É"]
    CheckAuth{–û–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ<br/>–ø—Ä–∞–≤–∏–ª—å–Ω—ñ?}
    AuthError["‚ùå –ù–µ–≤—ñ—Ä–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ"]
    LoadUserProfile["üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å"]
    SetAuthContext1["üîë –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Auth Context"]
    
    %% Register Flow
    RegisterStart["üìù –°—Ç–æ—Ä—ñ–Ω–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó"]
    EnterRegCreds["–í–≤–µ–¥–µ–Ω–Ω—è email, —ñ–º–µ–Ω—ñ, –ø–∞—Ä–æ–ª—è"]
    ValidateRegCreds{–î–∞–Ω—ñ<br/>–≤–∞–ª—ñ–¥–Ω—ñ?}
    RegError["‚ùå –ü–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É"]
    CheckEmailExists{Email<br/>—ñ—Å–Ω—É—î?}
    EmailExistsError["‚ùå Email –≤–∂–µ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π"]
    CreateFirebaseUser["üë§ –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ Firebase"]
    SaveUserData["üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –¥–∞–Ω—ñ –≤ –ë–î"]
    SendWelcomeEmail["üìß –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ email"]
    SetAuthContext2["üîë –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Auth Context"]
    
    %% Home Page
    HomePage["üè† –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞"]
    ViewProducts["üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–¥–∞–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤"]
    
    %% ========== MEDICINES CATALOG ==========
    SearchMedicines["üîç –ü–æ—à—É–∫ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ñ–≤"]
    FilterMedicines["üéØ –§—ñ–ª—å—Ç—Ä—É–≤–∞–Ω–Ω—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º"]
    ViewDetails["üìä –ü–µ—Ä–µ–≥–ª—è–¥ –¥–µ—Ç–∞–ª–µ–π —Ç–æ–≤–∞—Ä—É"]
    
    %% ========== SHOPPING CART ==========
    AddToCart["üõí –î–æ–¥–∞—Ç–∏ –¥–æ –∫–æ—à–∏–∫–∞"]
    UpdateQuantity["üî¢ –û–Ω–æ–≤–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å"]
    RemoveItem["üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –∑ –∫–æ—à–∏–∫–∞"]
    ViewCart["üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–¥ –∫–æ—à–∏–∫–∞"]
    
    %% ========== CHECKOUT ==========
    ProceedCheckout["üí≥ –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è"]
    CheckInventory{–¢–æ–≤–∞—Ä–∏<br/>–≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ?}
    InventoryError["‚ùå –¢–æ–≤–∞—Ä–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ"]
    ReturnCart["‚Ü©Ô∏è –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≤ –∫–æ—à–∏–∫"]
    EnterDeliveryAddr["üìç –í–≤–µ–¥–µ–Ω–Ω—è –∞–¥—Ä–µ—Å–∏ –¥–æ—Å—Ç–∞–≤–∫–∏"]
    ValidateAddr{–ê–¥—Ä–µ—Å–∞<br/>–≤–∞–ª—ñ–¥–Ω–∞?}
    AddrError["‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –∞–¥—Ä–µ—Å–∞"]
    ProcessPayment["üí∞ –û–±—Ä–æ–±–∫–∞ –ø–ª–∞—Ç–µ–∂—É"]
    PaymentSuccess{–ü–ª–∞—Ç—ñ–∂<br/>—É—Å–ø—ñ—à–Ω–∏–π?}
    PaymentError["‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–ª–∞—Ç–µ–∂—É"]
    RetryPayment{–ü–æ–≤—Ç–æ—Ä–∏—Ç–∏?}
    CreateOrder["üìù –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"]
    SendOrderEmail["üìß –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ email –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"]
    ClearCart["üßπ –û—á–∏—Å—Ç–∏—Ç–∏ –∫–æ—à–∏–∫"]
    OrderSuccess["‚úÖ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–µ"]
    
    %% ========== ORDERS & TRACKING ==========
    ViewOrders["üìã –ü–µ—Ä–µ–≥–ª—è–¥–∞–Ω–Ω—è –º–æ—ó—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å"]
    SelectOrder["üîç –í–∏–±—ñ—Ä –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"]
    TrackOrder["üìç –í—ñ–¥—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"]
    
    %% ========== PROFILE ==========
    ViewProfile["üë§ –ú—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å"]
    EditProfile["‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é"]
    ChangePassword["üîë –ó–º—ñ–Ω–∞ –ø–∞—Ä–æ–ª—è"]
    SaveProfile["üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏"]
    
    %% ========== ADMIN PANEL ==========
    AdminAuth{–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á<br/>–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä?}
    AdminPanel["‚öôÔ∏è –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å"]
    
    %% Medicine Management
    ManageMedicines["üè• –ö–µ—Ä—É–≤–∞–Ω–Ω—è –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∞–º–∏"]
    AddMedicine["‚ûï –î–æ–¥–∞—Ç–∏ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç"]
    FillMedForm["üìù –ó–∞–ø–æ–≤–Ω–∏—Ç–∏ —Ñ–æ—Ä–º—É"]
    ValidateMedForm{–§–æ—Ä–º–∞<br/>–≤–∞–ª—ñ–¥–Ω–∞?}
    MedFormError["‚ùå –ü–æ–º–∏–ª–∫–∞ —Ñ–æ—Ä–º–∏"]
    SaveMedicine["üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç"]
    
    EditMedicine["‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç"]
    SelectMedicine["üîç –í–∏–±—Ä–∞—Ç–∏ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç"]
    UpdateMedicine["üîÑ –û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ"]
    
    DeleteMedicine["üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç"]
    ConfirmDelete{–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏<br/>–≤–∏–¥–∞–ª–µ–Ω–Ω—è?}
    RemoveMedicine["üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏ –∑ –ë–î"]
    
    %% Order Management
    ManageOrders["üì¶ –ö–µ—Ä—É–≤–∞–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏"]
    ViewAllOrders["üìã –í—Å–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"]
    UpdateOrderStatus["üîÑ –û–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å"]
    SelectNewStatus["üìå –í–∏–±—ñ—Ä –Ω–æ–≤–æ–≥–æ —Å—Ç–∞—Ç—É—Å—É"]
    ConfirmStatus{–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏<br/>–∑–º—ñ–Ω—É?}
    SaveStatus["üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ —Å—Ç–∞—Ç—É—Å"]
    NotifyCustomer["üìß –°–ø–æ–≤—ñ—Å—Ç–∏—Ç–∏ –∫–ª—ñ—î–Ω—Ç–∞"]
    
    CancelOrder["‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è"]
    ConfirmCancel{–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏<br/>—Å–∫–∞—Å—É–≤–∞–Ω–Ω—è?}
    CheckOrderStatus{–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è<br/>–≤–∏–∫–æ–Ω–∞–Ω–µ?}
    CancelError["‚ùå –ù–µ –º–æ–∂–Ω–∞ —Å–∫–∞—Å—É–≤–∞—Ç–∏"]
    ProcessRefund["üí∞ –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≥—Ä–æ—à–µ–π"]
    SaveCancel["üíæ –ü–æ–∑–Ω–∞—á–∏—Ç–∏ —Å–∫–∞—Å–æ–≤–∞–Ω–∏–º"]
    
    %% Users Management
    ManageUsers["üë• –ö–µ—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏"]
    ViewAllUsers["üìä –°–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤"]
    ViewUserStats["üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤"]
    ViewSystemStats["üìä –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"]
    
    Logout["üö™ –í–∏—Ö—ñ–¥"]
    End([‚úÖ –ü—Ä–æ—Ü–µ—Å –∑–∞–≤–µ—Ä—à–µ–Ω–æ])
    
    %% ========== CONNECTIONS ==========
    Start --> AuthCheck
    
    %% Authentication Flows
    AuthCheck -->|–ù—ñ| LoginStart
    LoginStart --> EnterLoginCreds
    EnterLoginCreds --> ValidateLoginCreds
    ValidateLoginCreds -->|–ù—ñ| LoginError
    LoginError --> EnterLoginCreds
    ValidateLoginCreds -->|–¢–∞–∫| CheckAuth
    CheckAuth -->|–ù—ñ| AuthError
    AuthError --> EnterLoginCreds
    CheckAuth -->|–¢–∞–∫| LoadUserProfile
    LoadUserProfile --> SetAuthContext1
    
    AuthCheck -->|–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è| RegisterStart
    RegisterStart --> EnterRegCreds
    EnterRegCreds --> ValidateRegCreds
    ValidateRegCreds -->|–ù—ñ| RegError
    RegError --> EnterRegCreds
    ValidateRegCreds -->|–¢–∞–∫| CheckEmailExists
    CheckEmailExists -->|–¢–∞–∫| EmailExistsError
    EmailExistsError --> EnterRegCreds
    CheckEmailExists -->|–ù—ñ| CreateFirebaseUser
    CreateFirebaseUser --> SaveUserData
    SaveUserData --> SendWelcomeEmail
    SendWelcomeEmail --> SetAuthContext2
    
    SetAuthContext1 --> HomePage
    SetAuthContext2 --> HomePage
    AuthCheck -->|–¢–∞–∫| HomePage
    
    %% Home Page
    HomePage --> ViewProducts
    ViewProducts --> SearchMedicines
    SearchMedicines --> FilterMedicines
    FilterMedicines --> ViewDetails
    ViewDetails --> AddToCart
    
    %% Shopping Cart Management
    AddToCart --> ViewCart
    ViewCart --> UpdateQuantity
    UpdateQuantity --> ViewCart
    ViewCart --> RemoveItem
    RemoveItem --> ViewCart
    
    %% Checkout Flow
    ViewCart --> ProceedCheckout
    ProceedCheckout --> CheckInventory
    CheckInventory -->|–ù—ñ| InventoryError
    InventoryError --> ReturnCart
    ReturnCart --> ViewCart
    CheckInventory -->|–¢–∞–∫| EnterDeliveryAddr
    EnterDeliveryAddr --> ValidateAddr
    ValidateAddr -->|–ù—ñ| AddrError
    AddrError --> EnterDeliveryAddr
    ValidateAddr -->|–¢–∞–∫| ProcessPayment
    ProcessPayment --> PaymentSuccess
    PaymentSuccess -->|–ù—ñ| PaymentError
    PaymentError --> RetryPayment
    RetryPayment -->|–¢–∞–∫| ProcessPayment
    RetryPayment -->|–ù—ñ| HomePage
    PaymentSuccess -->|–¢–∞–∫| CreateOrder
    CreateOrder --> SendOrderEmail
    SendOrderEmail --> ClearCart
    ClearCart --> OrderSuccess
    OrderSuccess --> HomePage
    
    %% Orders and Tracking
    HomePage --> ViewOrders
    HomePage --> ViewProfile
    HomePage --> AdminAuth
    ViewOrders --> SelectOrder
    SelectOrder --> TrackOrder
    TrackOrder --> HomePage
    
    %% Profile Management
    ViewProfile --> EditProfile
    EditProfile --> ChangePassword
    ChangePassword --> SaveProfile
    SaveProfile --> HomePage
    
    %% Admin Functions
    AdminAuth -->|–ù—ñ| Logout
    AdminAuth -->|–¢–∞–∫| AdminPanel
    
    AdminPanel --> ManageMedicines
    AdminPanel --> ManageOrders
    AdminPanel --> ManageUsers
    
    %% Medicine Management
    ManageMedicines --> AddMedicine
    ManageMedicines --> EditMedicine
    ManageMedicines --> DeleteMedicine
    
    AddMedicine --> FillMedForm
    FillMedForm --> ValidateMedForm
    ValidateMedForm -->|–ù—ñ| MedFormError
    MedFormError --> FillMedForm
    ValidateMedForm -->|–¢–∞–∫| SaveMedicine
    SaveMedicine --> ManageMedicines
    
    EditMedicine --> SelectMedicine
    SelectMedicine --> FillMedForm
    FillMedForm --> UpdateMedicine
    UpdateMedicine --> ManageMedicines
    
    DeleteMedicine --> ConfirmDelete
    ConfirmDelete -->|–ù—ñ| ManageMedicines
    ConfirmDelete -->|–¢–∞–∫| RemoveMedicine
    RemoveMedicine --> ManageMedicines
    
    %% Order Management
    ManageOrders --> ViewAllOrders
    ManageOrders --> ManageUsers
    ViewAllOrders --> UpdateOrderStatus
    ViewAllOrders --> CancelOrder
    
    UpdateOrderStatus --> SelectNewStatus
    SelectNewStatus --> ConfirmStatus
    ConfirmStatus -->|–ù—ñ| ViewAllOrders
    ConfirmStatus -->|–¢–∞–∫| SaveStatus
    SaveStatus --> NotifyCustomer
    NotifyCustomer --> ViewAllOrders
    
    CancelOrder --> ConfirmCancel
    ConfirmCancel -->|–ù—ñ| ViewAllOrders
    ConfirmCancel -->|–¢–∞–∫| CheckOrderStatus
    CheckOrderStatus -->|–¢–∞–∫| CancelError
    CancelError --> ViewAllOrders
    CheckOrderStatus -->|–ù—ñ| ProcessRefund
    ProcessRefund --> SaveCancel
    SaveCancel --> NotifyCustomer
    
    %% Users Management
    ManageUsers --> ViewAllUsers
    ManageUsers --> ViewUserStats
    ViewAllUsers --> ViewSystemStats
    ViewUserStats --> ViewSystemStats
    ViewSystemStats --> AdminPanel
    
    AdminPanel --> Logout
    HomePage --> Logout
    Logout --> End
    
    %% Styling
    style Start fill:#90EE90,stroke:#228B22,stroke-width:3px
    style End fill:#FFB6C6,stroke:#DC143C,stroke-width:3px
    style AuthCheck fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style ValidateLoginCreds fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style CheckAuth fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style ValidateRegCreds fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style CheckEmailExists fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style CheckInventory fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style ValidateAddr fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style PaymentSuccess fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style RetryPayment fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style AdminAuth fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style ValidateMedForm fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style ConfirmDelete fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style ConfirmStatus fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style ConfirmCancel fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    style CheckOrderStatus fill:#87CEEB,stroke:#4169E1,stroke-width:2px
    
    style ProcessPayment fill:#FFD700,stroke:#FF8C00,stroke-width:2px
    style CreateOrder fill:#FFD700,stroke:#FF8C00,stroke-width:2px
    style SaveMedicine fill:#FFD700,stroke:#FF8C00,stroke-width:2px
    style UpdateMedicine fill:#FFD700,stroke:#FF8C00,stroke-width:2px
    style RemoveMedicine fill:#FFD700,stroke:#FF8C00,stroke-width:2px
    style SaveStatus fill:#FFD700,stroke:#FF8C00,stroke-width:2px
    style ProcessRefund fill:#FFD700,stroke:#FF8C00,stroke-width:2px
    style SaveCancel fill:#FFD700,stroke:#FF8C00,stroke-width:2px
